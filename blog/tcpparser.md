description: 将通过wireshark抓取的包进行解析，重组生成静态网页。
Title: 信安Pcap解析
Keywords: pcap parse
Author: Jin Jay
Date: 2014-05

## 信息安全解析pcap包获取网页内容

### 步骤一
解析pcap包，将使用ipv4和TCP协议的包取出生成新的pcap包。即读取pcap包内容，判断并取出对应的ip协议的协议版本字段为4且服务类型为TCP的报文，重新组装后生成新的pcap包。

### 步骤二
读取步骤一生成的pcap包，按照**(源ip,目的ip,源port,目的port)**四元组进行hash，得到包含相同的四元组值的hash表。 

### 步骤三
由于唯一的四元组能够确定唯一的tcp连接，故步骤二得到的hash表每一个关键字都对应的是一个文件。这一步考虑seq和ack的次序对hash表中每一个关键字链表进行**排序**。使用冒泡排序。

### 步骤四
步骤三得到的链表可能会出现有多余的包，这一次遍历链表**去掉重复的包**。

### 步骤五
得到了有序的包的链表后，现在将TCP上层应用层协议HTTP中的数据进行按顺序组装，便可得到重组文件。

### 总结
pcap包解析重组文件的整体思路如上，思路比较清晰，但是需要关注的细节很多，比如大小端问题，需要足够小心仔细。


[TOC]
